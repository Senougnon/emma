<!DOCTYPE html>
<html>
<head>
<title>MeSomb Payment Form</title>
</head>
<body>

<h2>MeSomb Payment</h2>

<form id="payment-form">
  <label for="amount">Amount:</label>
  <input type="number" id="amount" name="amount" value="100" required><br><br>

  <label for="payer">Phone Number:</label>
  <input type="tel" id="payer" name="payer" placeholder="2376XXXXXXXX" required><br><br>

  <label for="service">Service:</label>
  <select id="service" name="service" required>
    <option value="MTN">MTN Mobile Money</option>
    <option value="ORANGE">Orange Money</option>
  </select><br><br>

  <button type="submit">Pay Now</button>
</form>

<div id="payment-result"></div>

<script>
const form = document.getElementById("payment-form");
form.addEventListener("submit", (event) => {
  event.preventDefault(); // Prevent default form submission

  // Your MeSomb Application Key
  const applicationKey = "9b80d408cb3b0577c2a8125bc0739cfcdca9d090";

  // Get payment details from the form
  const paymentData = {
    amount: parseFloat(document.getElementById("amount").value),
    payer: document.getElementById("payer").value,
    fees: true,
    service: document.getElementById("service").value,
    country: "CM",
    currency: "XAF"
  };

  // Construct the request
  const requestOptions = {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "X-MeSomb-Application": applicationKey
    },
    body: JSON.stringify(paymentData)
  };

  // Make the API call
  fetch("/api/v1.1/payment/collect/", requestOptions)
    .then(response => response.json())
    .then(data => {
      // Handle the response
      if (data.success) {
        displayResult("Payment successful!");
      } else {
        displayResult(`Payment failed: ${data.message}`);
      }
    })
    .catch(error => {
      console.error("Error:", error);
      displayResult("An error occurred during payment.");
    });
});

function displayResult(message) {
  const resultDiv = document.getElementById("payment-result");
  resultDiv.innerHTML = `<p>${message}</p>`;
}
</script>

</body>
</html>
